import allReceivers from './messages.mjs'
// в файле указаны все получатели
import {
    constants, copyFile, unlink, writeFile, writeFileSync, appendFileSync
} from 'fs';


const generateDownloadLink = (uid = '59449', filename = 'pdf') =>{
    let link = 
`https://hselyceum.eljur.ru/journal-index-my-studentmarks-action/u.${uid}/part./fn.marks?mode=${filename}`
    return link
}


// проходимся по всему массиву
const filename_links = 'links'
const filename_names = 'names'
allReceivers.forEach(function(data, index) {
    let target = data.uid;//выбираем, что нам нужно
    //Нам понадобятся id каждого пользователя
    let name = `${data.firstname}_${data.lastname}`
    let link = generateDownloadLink(target);


    // записываем в файл - они понадобятся для curl скрипта    
    appendFileSync(`./${filename_links}.txt`, `${link}\n`);
    appendFileSync(`./${filename_names}.txt`, `${name}\n`);
    
  });






